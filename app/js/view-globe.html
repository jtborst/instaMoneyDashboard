<script type="text/javascript">
    countryMapping = new Array();
    $(document).ready(function() {

        // TODO
//        if (!window.loadedCountries) {
//            $.ajax({
//                method: "POST",
//                url: "/umbraco/surface/GlobeData/Countries",
//                context: document.body
//            }).success(function(data) {
//                window.loadedCountries = data;
//                createSelects(data);
//            });
//        } else {
            createSelects(getDummyCountries());
//            createSelects([]);
//        }


    });

    function createSelects(data) {
//        $('#content').hide();
        countryMapping = mapCountries(data);

//        var $select = $('#countryInput');
//        $select.empty();
//        $select.append($('<option />', { value: 'default', text: 'Select a country' }));
//        for (var index = 0; index < data.length; index++) {
//            var country = data[index];
//            $select.append($('<option />', { value: country.countryCode, text: country.name }));
//        }
//        $('#countryInput').selectpicker({
//            hideDisabled: true
//        });

//        var $selectFallback = $('#countryInputFallback');
//        $selectFallback.empty();
//        $selectFallback.append($('<option />', { value: 'default', text: 'Select a country' }));
//        for (var index = 0; index < data.length; index++) {
//            var country = data[index];
//            $selectFallback.append($('<option />', { value: country.countryCode, text: country.name }));
//        }
//        $('#countryInputFallback').selectpicker({
//            hideDisabled: true
//        });


//        if (!_fallbackLoaded || !_fallbackLoading) {
            $('#hud').show();

            startIdleToActiveTransition(JSON.stringify(data));

//            $('#selectCountryBox').show();
//
//
//            $("#countryInput").unbind('change');
//            $('#countryInput').on('change', function () {
//                if (keydownPressed) {
//                    console.log("set keydownpressed to false");
//                    keydownPressed = false;
//                    return;
//                }
//                // disableScroll();
//
//                $(window).scrollTop(0);
//                $('body').css('overflow-y', 'hidden');
//
//                console.log("disabled scroll");
//                $('#countryInput').attr('disabled', true);
//                console.log('select disabled');
//                $('#countryInput').selectpicker('refresh');
//                $('.wrapper-tabs').removeClass('isFixed fallback').prependTo('#country');
//                selectedCountryCode = $(this).val();
//                setCallbackForFocusAfterClickingOnFlag(testCountryClicked);
//                focusOnCountryByCountryCode(
//                    $(this).val()
//                );
//            });
//        } else {
//            console.log("Fallback selected");
//            $('#selectCountryBox').hide();
//
//            setTimeout(function () {
//                $('.fallback-container, .box-wrapper-fallback').fadeIn();
//            }, 500);
//
//
//
//
//            $("#fallbackCountrySelector").unbind('click');
//            $('#fallbackCountrySelector').on('click', function() {
//                $(window).scrollTop(0);
//                $('body').css('overflow-y', 'hidden');
//
//                console.log("disabled scroll");
//                if ($('#countryInputFallback').val() !== "default") {
//                    $('#globeLink').fadeIn();
//                    $('#selectCountryBox').fadeIn();
//                    $('.fallback-container .box-wrapper-fallback').fadeOut();
//                    $('#country').addClass('fallback');
//
//                    checkLoginState([$('#countryInputFallback option:selected').text()], loadCountry);
//
//                    $select = $('#countryInput');
//                    $select.addClass('country-selectInput');
//                    $('#countryInput option[value="default"]').prop('disabled', true);
//                    console.log($('#countryInputFallback option:selected').val().toUpperCase());
//                    $('#countryInput[name=countryInput]').val($('#countryInputFallback option:selected').val().toUpperCase());
//                    $select.selectpicker('refresh');
//
//
//                }
//            });
//
//            $("#countryInput").unbind('change');
//            $('#countryInput').on('change', function () {
//                if (keydownPressed) {
//                    console.log("set keydownpressed to false");
//                    keydownPressed = false;
//                }
//                $(window).scrollTop(0);
//                $('body').css('overflow-y', 'hidden');
//
//                console.log("disabled scroll");
//                $('#countryInput').attr('disabled', true);
//                console.log('select disabled');
//                if ($('#countryInput').val() !== "default") {
//                    $('#globeLink').fadeIn();
//                    $('#selectCountryBox').fadeIn();
//                    $('.fallback-container .box-wrapper-fallback').fadeOut();
//                    $('#country').addClass('fallback');
//                    $('.wrapper-tabs').removeClass('isFixed fallback').prependTo('#country');
//                    $('#country').html('').hide();
//
//                    $select = $('#countryInput');
//                    $select.addClass('country-selectInput');
//                    // $('#countryInput option[value="default"]').prop('disabled', true);
//                    console.log($('#countryInput option:selected').val().toUpperCase());
//                    $select.selectpicker('refresh');
//
//                    checkLoginState([$('#countryInput option:selected').text()], loadCountry);
//                }
//            });
//        }
    }
</script>
